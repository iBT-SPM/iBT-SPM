%
% The Integrated Brain Analysis Toolbox for SPM (iBT)
%   (historically known as the iBrain Analysis Toolbox for SPM, or iBrainTools)
% Copyright (C) 2011-2025, 
%    The Florey Institute of Neuroscience and Mental Health
% _____________________________________________________________________________
% 
% Please refer to this version as "iBT v4.0" in papers and communications
% and cite the following abstract from OHBM2024:
%
%  Abbott DF, Capon A, Tailby C, Tahayori B, Bryant MF, 
%  Vaughan DN, Jackson GD, for the Australian Epilepsy Project Investigators. 
%  The Integrated Brain Analysis Toolbox for SPM (iBT). 
%  Aperture Neuro, 4 (Suppl 1), 3677–3679 https://doi.org/10.52294/001c.120595
%
% An earlier version of this toolbox was presented at HBM2011:
%   Abbott DF, Masterton RAJ, Waites AB, Bhaganagarapu K, Pell GS, 
%   Harvey MR, Sharma GJ, Jackson GD. "The iBrain Analysis Toolbox 
%   for SPM". Proceedings of the 17th Annual Meeting of the Organisation
%   for Human Brain Mapping, Quebec City, Canada. 364 WTh. (2011)
%
% Please refer to the following for a description of the laterality
% methods implemented in this toolbox. If you publish laterality
% results using these methods or variations of them, please cite 
% this paper: 
%     Abbott DF, Waites AB, Lillywhite LM, Jackson GD.
%     fMRI assessment of language lateralization: An objective approach. 
%     NeuroImage 50(4):1446-1455 (2010).
% 
% iBT v4.0 was tested with SPM12 r7771. iBT v4.0 likely also remains
%  compatible with earlier SPM12 and SPM8 releases.
%
% If you wish to use iBT for spatial normalisation, be aware that 
% iBT v4.0 with SPM12 continues to use the "old" spatial normalisation
% routine, consistent with the default spatial normalisation in SPM8. 
% If you wish to use SPM's newer algorithms, please pre-process
% using SPM12's own batch engine directly, and then utilize iBT for
% the statistical analysis and display. 
% Alternatively, consider preprocessing with fMRIPrep.
%
% Some optional features of iBT utilise software other than SPM, including:
%   * iBrain, for optimum realignment target determination, iterative
%     within-brain mask determination, GE Signa image conversion,
%     and an alternative DICOM conversion function.
%   * FSL, for within-brain mask determination using BET, 
%     and for fslsplit 4D to 3D image conversion.
%
% Some features of iBT, including the laterality analysis
% features, can also operate on data not necessarily generated by SPM.
%
% If you wish to use the laterality analysis features, please also take a
% look at README_Laterality.txt
%
% Installation: The iBT folder should be installed in the toolbox
%  folder of your SPM installation. Users may also wish to customise
%  runinfo*_template.m and studylist*_template.txt files for their site.
%  Take note in particular that the default installation has settings 
%  to display in RADIOLOGICAL orientation (subject's left on image right).
%  If you wish to change this for your site, please alter the 
%  iBT.what.disp.orient.LeftOnRight field in each supplied runinfo*template.m
%  file. Note also that this flag is not relevant to laterality curves; they
%  are never "flipped".
% 
% Usage:
%  1. Use "File -> Create new runinfo.m" to create a file in the 
%     current folder which will indicate what you want done. Edit 
%     this with a text editor to suit your requirements. There are 
%     comments in the file to help you configure it.
%  2. (Optional): You may choose to list subject ID, study location and
%     task labels in a file separate from runinfo.m. This can be more
%     convenient, especially if other details tend to remain the same 
%     for your studies. You can create a new studylist.txt file based on
%     an example template with "File -> Create new studylist.txt", then
%     edit it as appropriate. Make sure your runinfo.m is configured to
%     load this file.
%  3. Select "Run -> Run job" to run the program. You will be 
%     prompted to select the runinfo file you want to use and the 
%     toolbox will run with the settings configured in that file.
%
%  You may also use the shortcut 'ibt' command in Matlab to run a job 
%  previously created from the toolbox without first initialising SPM, if
%  the location of ibt.m and SPM are both in your Matlab path. Without
%  arguments, ibt will display a GUI for you to select runinfos to process.
%
% Advanced usage:
% runinfo files can be executed from the MATLAB command line without
% a GUI using filename arguments to the ibt command. For example:
%  ibt('runinfo.m')
% Multiple runinfos can also be chained together:  
%  ibt(filespec_part1, filespec_part2, ...)
%   In this scenario, filenames matching each argument are resolved
%   and then the first analysis proceeds by chaining together
%   the first match from filespec_part1 and the first match from
%   filespec_part2 etc. That is, it acts as if the contents of these
%   first matching runinfos are concatenated. Once that analysis is
%   complete, the next analysis proceeds by chaining the second match 
%   in each filespec (if any) and so on. 
%   If any of the filespecs match only one file, then that
%   file is used in every analysis. In this way, one can
%   utilise a single master runinfo with settings in common to
%   several analyses, specified for example as filespec_part1, and
%   then chain to it a much simpler runinfo containing only the relevant 
%   overrides to the master, specified as filespec_part2. Each filename
%   matching filespec_part2 would then execute as a separate analysis
%   chained to the single master runinfo.
%   Another potential use case would be to provide a common override to
%   multiple runinfos. For example one could indicate
%   pre-processing of all runinfos has already been completed, without
%   having to edit every single runinfo.
%
% _____________________________________________________________________________
% 
% iBT is free software: you can redistribute it and/or modify it under
% the terms of the GNU General Public License as published by
% the Free Software Foundation, either version 3 of the License, or 
% (at your option) any later version.
% 
% iBT is distributed in the hope that it will be useful, but WITHOUT
% ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or 
% FITNESS FOR A PARTICULAR PURPOSE.
% See the GNU General Public License for more details.
% 
% You should have received a copy of the GNU General Public License
% along with this program (see LICENCE.txt). If not, 
% see <http://www.gnu.org/licenses/>.
% _____________________________________________________________________________
%
% Acknowledgments: 
% Some of the code in this toolbox was adapted from code in the public
% domain or released under the GNU General Public License or compatible
% licences outside of the official SPM releases by the following authors,
% whom we thank for their contributions:
%   Rik Henson for a simple SPM pre-processing script (2003-05-20) 
%   Karl Friston for a simple SPM stats script (posted 2002-11-25)
%   Matthew Brett for display_slices V0.4 (5/9/03)
%   Stefan Eireiner for a compact RLE decoding algorithm (2004-05-24)
%   Jan Gläscher for nanmedian (2007/07/30) and nanstd (2004/07/15)
%
% The Florey Institute of Neuroscience and Mental Health acknowledges
% support from the Victorian Government and in particular the funding
% from the Operational Infrastructure Support Grant. We also
% thank the Australian National Imaging Facility for
% fellowship funding support.
%
