%
% Quick-start Guide to the Laterality tools in iBT
% ________________________________________________

% All functions of the original iBrain Laterality Toolbox are now 
% integrated into this more general Integrated Brain Analysis 
% Toolbox for SPM (iBT).
%
% The laterality methods implemented in this toolbox are described in
% detail in the following paper. If you publish laterality
% results using these methods or variations of them, please cite 
% this paper: 
%     Abbott DF, Waites AB, Lillywhite LM, Jackson GD.
%     fMRI assessment of language lateralization: An objective approach.
%     NeuroImage 50(4):1446-1455 (2010).
%
% To get started quickly, here is a brief summary of how you can generate
% laterality curves for existing statistical maps (such maps could have
% been generated by iBT, or with SPM on its own, or with any
% other software for that matter). All you need are the following two
% things in the NIfTI-1 image data format (or the older Analyze format if
% you are careful to ensure the orientations of the images match):
% 1. One or more statistical maps for which you wish to determine laterality
% 2. Two image masks defining the regions of interest (ROIs) to be 
%    compared. These must have the same dimensions and be in the same
%    co-ordinate space as the statistical map above. For conventional 
%    laterality these would be the left and right regions that might
%    typically be active in the task that you are studying (the software
%    variables are labelled with this in mind). However in practice the ROIs
%    can be any regions for which you wish to determine the balance of
%    activity.
%
% In this quick-start guide, we will create and configure a standalone
% runinfo_li.m file to do the laterality processing. However if you are
% already doing your image processing and analysis with iBT
% then it would be easier to just configure the laterality analysis options
% within your existing runinfo.m file (in the iBT.what.li.do section).
%
% Create a runinfo_li.m file from the included runinfo_li_template.m file
% included with iBT (either copy it directly and edit it with your
% favourite text editor, or you can create it and edit it from the 
% iBT graphical user interface in the Toolbox menu of SPM).
%
% The runinfo file is just a simple Matlab script that sets variables to tell
% the toolbox where the data is and what to do with it. The variables are
% listed with default values together with comments indicating what they 
% control. In this quick-start guide we will just cover the essentials - you 
% can leave variables that we do not mention as-is.
%
% To tell the toolbox which data to process, we can either use a studylist
% file (which I find easier when there are lots of subjects) or you can
% specify this directly in the runinfo file (which we will do in this example).
%
% To avoid using a studylist file, set the studylistfile variable to an empty
% string (search or work your way down from the top of the runinfo until you find
% the line where studylistfile is set). By default it sets it to a file called
% studylist.txt and a commented-out line below sets it to an empty string
% (anything following a % character is a comment). So you can switch the comment
% so that the empty string setting takes effect - it will look something like
% the following:
%
%    %studylistfile='studylist_li.txt'; % non-blank string indicates read in details from file. 
%    studylistfile=''; % Blank string indicates setup within current runinfo file only
%
% Then tell the script where the statistical parametric map file(s) are for the
% first session of the first subject by setting iBT.who.sub{sub}.sess{1}.spmloc.
% There are some comments in the runinfo file that may be helpful if you are 
% generating the spm's in SPM software, but remember you can use any
% statistical maps no matter how generated. Also set the subject ID and task
% labels to suit (they are just labels, so are not critical, but the ID should
% be unique for each subject):
%
%    iBT.who.sub{sub}.ID = 'Test01'; 
%    iBT.who.sub{sub}.sess{1}.spmloc='path_to_wherever_this_subjects_stats_files_reside'; 
%    iBT.who.sub{sub}.sess{1}.task='Name_of_the_functional_task_performed'; 
%
% Now skip past the else section (which is code that would read the
% studylist if we had one) and set the iBT.what.li.wild variable to a string
% wildcard that will match your statistic images within the spmloc location  e.g.
%    iBT.what.li.wild=['stats*.nii']; 
%    
% Then you need to specify masks (images) that you want to use to indicate your
% regions of interest. These should be in the same dimensions and co-ordinate space
% as the subject that you are analysing. The runinfo template has the names of some
% files I use, but you will need to determine what is suitable for your study
% and provide these yourself.
%
%         iBT.what.li.roi_dir='/path/where/your/masks/reside/';
%         iBT.what.li.left_roi='ROI_L_all_cortical.img';  
%         iBT.what.li.right_roi='ROI_R_all_cortical.img'; 
%
% Finally, for your first iteration, you won't have laterality data generated for
% your control group yet, so set the control_dir to an empty string:
%
%          iBT.what.li.control_dir=''; % where previously calculated LI mat files are located
%
% With this done, save the file and you can then run the toolbox and select this
% runinfo file. It should then generate and display a laterality curve for each
% statistical image in your specified folder that matches your specified wildcard.
%
% Once you have this working, you can then add more subjects to get multiple
% curves. To generate a control group for statistical comparison of individuals
% to a control group,simply place the relevant (one per subject) li_active*.dat
% files generated by the toolbox into a single folder and set
% iBT.what.li.control_dir to that folder. Then the toolbox will also give you
% a graphical and quantitative assessment of whether an individual is "typical"
% when compared to the control group.
%
